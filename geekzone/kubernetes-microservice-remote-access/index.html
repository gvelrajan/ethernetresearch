<!doctype html><html lang=en><head><title>Kubernetes Microservice Remote Access - Ethernet Research</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Ethernet Research: Actionable information about cloud technologies at your fingertips"><meta name=author content="Ganesh Velrajan"><meta property="og:title" content="Kubernetes Microservice Remote Access"><meta property="og:description" content="In this document, we&rsquo;ll discuss how to develop, debug, and test a microservice locally on your laptop, without having to run all the other microservices of an app also on your laptop."><meta property="og:type" content="article"><meta property="og:url" content="http://www.ethernetresearch.com/geekzone/kubernetes-microservice-remote-access/"><meta property="og:image" content="http://www.ethernetresearch.com/images/kubernetes/kubernetes.jpg"><meta property="article:published_time" content="2020-10-29T00:00:00+00:00"><meta property="article:modified_time" content="2020-10-29T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://www.ethernetresearch.com/images/kubernetes/kubernetes.jpg"><meta name=twitter:title content="Kubernetes Microservice Remote Access"><meta name=twitter:description content="In this document, we&rsquo;ll discuss how to develop, debug, and test a microservice locally on your laptop, without having to run all the other microservices of an app also on your laptop."><meta name=generator content="Hugo 0.79.1"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=http://www.ethernetresearch.com/fontawesome/css/all.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda"><link rel=stylesheet type=text/css href=http://www.ethernetresearch.com/css/styles.css></head><body><div id=container><header><h1><a href=http://www.ethernetresearch.com/>Ethernet Research</a></h1><ul id=social-media><li><a href=https://linkedin.com/in/username title=LinkedIn><i class="fab fa-linkedin fa-lg"></i></a></li><li><a href=https://www.youtube.com/channel/UCnmHCstjZcevizOQ0qmANlw title=Youtube><i class="fab fa-youtube fa-lg"></i></a></li></ul><p><em>Actionable information about cloud technologies</em></p></header><nav><ul><li><a href=http://www.ethernetresearch.com/geekzone/><i class="fa-li fa fa-lg"></i><span>GeekZone</span></a></li><li><a href=http://www.ethernetresearch.com/articles/><i class="fa-li fa fa-lg"></i><span>Articles</span></a></li><li><a href=http://www.ethernetresearch.com/about/><i class="fa-li fa fa-lg"></i><span>About Us</span></a></li><li><a href=http://www.ethernetresearch.com/online-courses-training/><i class="fa-li fa fa-lg"></i><span>Online Courses</span></a></li><li><a href=http://www.ethernetresearch.com/contact/><i class="fa-li fa fa-lg"></i><span>Contact</span></a></li></ul></nav><main><article><h1>Kubernetes Microservice Remote Access</h1><aside><ul><li><time class=post-date datetime=2020-10-29T00:00:00Z>Oct 29, 2020</time></li><li>Categories:
<em><a href=http://www.ethernetresearch.com/categories/geekzone>GeekZone</a>
,
<a href=http://www.ethernetresearch.com/categories/kubernetes>Kubernetes</a></em></li><li><em><a href=http://www.ethernetresearch.com/tags/container>#Container</a>
,
<a href=http://www.ethernetresearch.com/tags/docker>#Docker</a>
,
<a href=http://www.ethernetresearch.com/tags/kubernetes>#Kubernetes</a>
,
<a href=http://www.ethernetresearch.com/tags/microservice>#Microservice</a>
,
<a href=http://www.ethernetresearch.com/tags/remote-access>#Remote Access</a></em></li><li>10 minute read</li></ul></aside><div class=featured_image><a href=http://www.ethernetresearch.com/geekzone/kubernetes-microservice-remote-access/ title="Kubernetes Microservice Remote Access"><img src=http://www.ethernetresearch.com/images/kubernetes/kubernetes.jpg></a></div><p>In this document, we&rsquo;ll discuss how to develop, debug, and test a microservice locally on your laptop, without having to run all the other microservices of an app also on your laptop.</p><p>The solution discussed in this document could also be used to debug, fix, and test a problem reported by your customer in your live production cluster by routing accesses to your microservice (that has the bug) to the one running in your laptop with the fix.</p><h2 id=problem-statement>Problem Statement:</h2><p>Let&rsquo;s say your team is focussed on developing and testing a front-end ReactJS microservice for your company&rsquo;s application that has like 25 other microservices such as Spring Boot, Elastic Search, Redis, Postgres, Grafana, and so on, in it.</p><p>As a dev, you would usually try to run all of these microservices in your laptop so that you could develop,build and test changes to your front-end ReactJS App natively on your laptop. But running all these 25 microservices on your laptop will make it into a toaster, because you are pushing your laptop cpu, memory and power consumption to their maximum capacity throughout the day.</p><h2 id=workarounds-used-today>Workarounds Used Today</h2><p>Many try to workaround this problem by upgrade their RAM or disk or fan module or even the laptop itself.</p><p>This adds more costs to your organization. Sometimes it may make you wonder, &ldquo;Was it really a smart decision to convert your monolithic applications into microservices, in the first place?&rdquo;</p><p>Many organizations that have started their journey into the microservices world, for the benefits it offers, have faced the exact same problem. And, fortunately, <a href=https://www.socketxp.com>SocketXP</a> has a solution to address this problem.</p><h2 id=wall-power-sockets-analogy>Wall Power Sockets Analogy</h2><p>Let me ask you this question. Would you run a huge power generator in your house just because you needed some electricity to run your TV, Air Conditioner and Washing machine? The answer would be &ldquo;no&rdquo;. You&rsquo;d just install a couple of sockets on your wall, run a power cable to the energy company in your city and hook up your electrical equipments to those wall sockets. Neat and simple isn&rsquo;t it?</p><p>Then why do we try to run all our microservices(both 800 pound gorillas and tiny little mice ones) on that poor little laptop on your lap, all day long, just because you need to focus on developing and testing one front-end microservice? You could very well install software &ldquo;wall sockets&rdquo; on your laptop and have your ReactJS front-end microservice talk to 25 other microservices running remotely in a cloud (or some on-prem cluster perhaps?) via the software &ldquo;wall sockets&rdquo; And vice-versa.</p><p>Our SocketXP Microservice Remote Access solution would help create those software &ldquo;wall-sockets&rdquo; in your laptop, for all your remote microservices.</p><h2 id=how-socketxp-microservice-remote-access-solution-works>How SocketXP Microservice Remote Access Solution Works?</h2><p>You need to download and run a SocketXP proxy agent (also available as Docker Container) on your laptop and on your remote cluster where other N-1 microservices of your application reside.</p><p>SocketXP proxy agent will create &ldquo;TCP/IP&rdquo; sockets on your laptop (one for each of the microservice running in a remote cluster) and run a bidirectional TLS tunnel between your laptop and your remote cluster. We&rsquo;d also adjust DNS records (for those remotely running microservices) in your laptop to route to the localhost IP address. So that, any requests from your front-end microservices to these 25 other microservices, would be routed to these local sockets.</p><p>::: tip Why this is important:
Your front-end microservice would continue to connect to other microservices of the app as usual, without requiring any modifications to its code or configurations.
:::</p><h2 id=docker-container-demo>Docker Container Demo</h2><p>For this exercise, we are going to run Postgres DB as a Docker Container in a remote server and make a python based backend microservice (under development in my laptop) access the remote DB via the SocketXP proxy.</p><p>Postgres DB is accessible via the hostname <code>postgres</code> and port <code>5432</code></p><p>Here is the simple backend microservice written in python.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#960050;background-color:#1e0010>$</span>cat backend<span style=color:#f92672>.</span>py 
<span style=color:#f92672>import</span> psycopg2

con <span style=color:#f92672>=</span> psycopg2<span style=color:#f92672>.</span>connect(database<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;postgres&#34;</span>, user<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;gvelrajan&#34;</span>, password<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;pa$$word123&#34;</span>, host<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;postgres&#34;</span>, port<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;5432&#34;</span>)

<span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;Database opened successfully&#34;</span>)

cur <span style=color:#f92672>=</span> con<span style=color:#f92672>.</span>cursor()
cur<span style=color:#f92672>.</span>execute(<span style=color:#e6db74>&#39;&#39;&#39;CREATE TABLE STUDENT
</span><span style=color:#e6db74>      (ADMISSION INT PRIMARY KEY     NOT NULL,
</span><span style=color:#e6db74>      NAME           TEXT    NOT NULL,
</span><span style=color:#e6db74>      AGE            INT     NOT NULL,
</span><span style=color:#e6db74>      COURSE        CHAR(50),
</span><span style=color:#e6db74>      DEPARTMENT        CHAR(50));&#39;&#39;&#39;</span>)

<span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;Table created successfully&#34;</span>)

cur<span style=color:#f92672>.</span>execute(<span style=color:#e6db74>&#34;INSERT INTO STUDENT (ADMISSION,NAME,AGE,COURSE,DEPARTMENT) VALUES (34231, &#39;Dave&#39;, 19, &#39;Information Technology&#39;, &#39;ICT&#39;)&#34;</span>);
cur<span style=color:#f92672>.</span>execute(<span style=color:#e6db74>&#34;INSERT INTO STUDENT (ADMISSION,NAME,AGE,COURSE,DEPARTMENT) VALUES (34232, &#39;Gary&#39;, 18, &#39;Electrical Engineering&#39;, &#39;ICT&#39;)&#34;</span>);
cur<span style=color:#f92672>.</span>execute(<span style=color:#e6db74>&#34;INSERT INTO STUDENT (ADMISSION,NAME,AGE,COURSE,DEPARTMENT) VALUES (34233, &#39;Abel&#39;, 17, &#39;Computer Science&#39;, &#39;ICT&#39;)&#34;</span>);

<span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;Student records added to the table successfully&#34;</span>)

con<span style=color:#f92672>.</span>commit()
con<span style=color:#f92672>.</span>close()
</code></pre></div><p>The python backend microservice connects to the DB using the hostname &lsquo;postgres&rsquo; and port &lsquo;5432&rsquo;</p><h3 id=run-the-postgres-db-docker-container>Run the Postgres DB Docker Container</h3><p>First create a docker volume</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ docker volume create postgres
</code></pre></div><p>Next run the Postgres DB container and mount the <code>postgres</code> volume in the host machine to the directory <code>/var/lib/postgresql/data</code> inside the container.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ docker run --name postgres --restart unless-stopped --net appnet --mount source<span style=color:#f92672>=</span>postgres,target<span style=color:#f92672>=</span>/var/lib/postgresql/data -e POSTGRES_USER<span style=color:#f92672>=</span>gvelrajan -e POSTGRES_PASSWORD<span style=color:#f92672>=</span>pa$$word123 -e POSTGRES_DB<span style=color:#f92672>=</span>postgres -d postgres:latest
</code></pre></div><h3 id=run-socketxp-proxy-agent-container-in-a-clusterserver>Run SocketXP Proxy Agent container in a Cluster/Server</h3><p>First go to <a href=https://portal.socketxp.com>SocketXP Portal</a>. Signup for a free account and get your authtoken there.</p><p>Use your authtoken in the below config file.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#960050;background-color:#1e0010>cat</span> <span style=color:#960050;background-color:#1e0010>config.json</span>
{
    <span style=color:#f92672>&#34;authtoken&#34;</span>: <span style=color:#e6db74>&#34;&lt;your-auth-token-goes-here&gt;&#34;</span>
    <span style=color:#e6db74>&#34;tunnel_enabled&#34;</span>: <span style=color:#66d9ef>true</span>, 
    <span style=color:#f92672>&#34;tunnels&#34;</span> : [{ 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://postgres:5432&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;postgres-mservice-cluster1&#34;</span>, 
    }] 
}
</code></pre></div><p>Store the config.json file in a local directory(/home/gvelrajan/config/config.json) and map the directory into the SocketXP docker container at /data as shown in the command below to start the docker container.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>docker run --name socketxp --restart unless-stopped --net appnet -d  -v /home/gvelrajan/config:/data expresssocket/socketxp:latest
</code></pre></div><p>Execute the following command to check the logs for success status or any errors:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>docker logs socketxp
</code></pre></div><p>It would have something like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>Connected.
TCP tunnel <span style=color:#f92672>[</span>gvelrajan-5bz4y6hi<span style=color:#f92672>]</span> created.
</code></pre></div><p>Now go to the SocketXP Portal&rsquo;s <a href=https://portal.socketxp.com/#/tunnels>Tunnel Page</a>. Check the name of the tunnel created and its status.</p><h3 id=run-socketxp-proxy-agent-on-your-laptop>Run SocketXP Proxy Agent on your Laptop</h3><p>First download the SocketXP Proxy Agent in your laptop from the <a href=https://www.socketxp.com/download>SocketXP download page</a>. SocketXP Proxy Agent is available for all OS versions - Windows/Mac/Linux.</p><p>Use the same SocketXP authtoken you used in the previous section to authenticate the proxy agent with SocketXP Cloud Gateway.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#960050;background-color:#1e0010>cat</span> <span style=color:#960050;background-color:#1e0010>config.json</span>
{
    <span style=color:#f92672>&#34;authtoken&#34;</span>: <span style=color:#e6db74>&#34;&lt;your-auth-token-goes-here&gt;&#34;</span>
    <span style=color:#e6db74>&#34;tunnel_enabled&#34;</span>: <span style=color:#66d9ef>true</span>, 
    <span style=color:#f92672>&#34;tunnels&#34;</span> : [{ 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://postgres:5432&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;postgres-mservice-cluster1&#34;</span>,
        <span style=color:#f92672>&#34;iot_slave&#34;</span>: <span style=color:#66d9ef>true</span>
    }] 
}
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ socketxp --config config.json
</code></pre></div><p>The above config requests socketxp agent to run in slave mode and create a local proxy TCP socket in your laptop at <code>127.0.0.1:5432</code>. Also it requests socketxp agent to create a secure TLS connection to the <code>postgres-mservice-cluster1</code> proxy device (running in your remote cluster or server) we created in the previous section.</p><blockquote><p><strong>Note:</strong>
Although it is called TCP socket, we run TLS on top of it. So your data is securely transmitted over the internet end-to-end.</p></blockquote><p>Next, update the DNS record in your laptop with the following command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ echo <span style=color:#e6db74>&#34;127.0.0.1    postgres&#34;</span> | sudo tee -a /etc/hosts &gt; /dev/null
</code></pre></div><p>We need to add the above hostname mapping for our <code>postgres</code> microservice so that any local requests to the microservice will be routed to our SocketXP proxy agent listening at IP <code>127.0.0.1</code>.</p><h3 id=run-the-python-backend-microserver>Run the python backend microserver</h3><p>We are all set to run the python backend microservice under development in our laptop.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ python backend.py
Database opened successfully
Table created successfully
Student records added to the table successfully
</code></pre></div><p>Let&rsquo;s validate this success by running an SQL query in our remote postgres database.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#960050;background-color:#1e0010>$</span> docker <span style=color:#66d9ef>exec</span> <span style=color:#f92672>-</span>it postgres psql <span style=color:#f92672>-</span>U gvelrajan postgres
postgres<span style=color:#f92672>=#</span> <span style=color:#960050;background-color:#1e0010>\</span><span style=color:#66d9ef>c</span> postgres
postgres<span style=color:#f92672>=#</span> <span style=color:#960050;background-color:#1e0010>\</span>d
          List <span style=color:#66d9ef>of</span> relations
 <span style=color:#66d9ef>Schema</span> <span style=color:#f92672>|</span>  Name   <span style=color:#f92672>|</span> <span style=color:#66d9ef>Type</span>  <span style=color:#f92672>|</span>   <span style=color:#66d9ef>Owner</span>   
<span style=color:#75715e>--------+---------+-------+-----------
</span><span style=color:#75715e></span> <span style=color:#66d9ef>public</span> <span style=color:#f92672>|</span> student <span style=color:#f92672>|</span> <span style=color:#66d9ef>table</span> <span style=color:#f92672>|</span> gannygans
(<span style=color:#ae81ff>1</span> <span style=color:#66d9ef>row</span>)
postgres<span style=color:#f92672>=#</span> <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> student;
 admission <span style=color:#f92672>|</span> name <span style=color:#f92672>|</span> age <span style=color:#f92672>|</span>                       course                       <span style=color:#f92672>|</span>                     department                     
<span style=color:#75715e>-----------+------+-----+----------------------------------------------------+----------------------------------------------------
</span><span style=color:#75715e></span>     <span style=color:#ae81ff>34231</span> <span style=color:#f92672>|</span> Dave <span style=color:#f92672>|</span>  <span style=color:#ae81ff>19</span> <span style=color:#f92672>|</span> Information Technology                             <span style=color:#f92672>|</span> ICT                                               
     <span style=color:#ae81ff>34232</span> <span style=color:#f92672>|</span> Gary <span style=color:#f92672>|</span>  <span style=color:#ae81ff>18</span> <span style=color:#f92672>|</span> Electrical Engineering                             <span style=color:#f92672>|</span> ICT                                               
     <span style=color:#ae81ff>34233</span> <span style=color:#f92672>|</span> Abel <span style=color:#f92672>|</span>  <span style=color:#ae81ff>17</span> <span style=color:#f92672>|</span> Computer Science                                   <span style=color:#f92672>|</span> ICT                                               
(<span style=color:#ae81ff>3</span> <span style=color:#66d9ef>rows</span>)

(<span style=color:#66d9ef>END</span>)
</code></pre></div><p>Awesome! We are able to develop/test our local python backend service and make it to seamlessly connect with the remote <code>postgres</code> DB microservice.</p><h2 id=make-a-remote-nginx-microservice-locally-accessible>Make a remote NGINX microservice locally accessible</h2><p>Now suppose, in addition to the postgres db microservice, we also need to make an NGINX microserice locally accessible from our laptop, use the following <code>config.json</code> file to setup the SocketXP Proxy Agent in the remote server/cluster.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#960050;background-color:#1e0010>cat</span> <span style=color:#960050;background-color:#1e0010>config.json</span>
{
    <span style=color:#f92672>&#34;authtoken&#34;</span>: <span style=color:#e6db74>&#34;&lt;your-auth-token-goes-here&gt;&#34;</span>
    <span style=color:#e6db74>&#34;tunnel_enabled&#34;</span>: <span style=color:#66d9ef>true</span>, 
    <span style=color:#f92672>&#34;tunnels&#34;</span> : [
      { 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://postgres:5432&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;postgres-mservice-cluster1&#34;</span>, 
      },
      { 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://nginx:80&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;nginx-mservice-cluster1&#34;</span>, 
      },
    ] 
}
</code></pre></div><p>Next, go to your laptop, and update the config.json file to create a local Proxy for the nginx microservice, as shown below.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#960050;background-color:#1e0010>cat</span> <span style=color:#960050;background-color:#1e0010>config.json</span>
{
    <span style=color:#f92672>&#34;authtoken&#34;</span>: <span style=color:#e6db74>&#34;&lt;your-auth-token-goes-here&gt;&#34;</span>
    <span style=color:#e6db74>&#34;tunnel_enabled&#34;</span>: <span style=color:#66d9ef>true</span>, 
    <span style=color:#f92672>&#34;tunnels&#34;</span> : [
      { 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://postgres:5432&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;postgres-mservice-cluster1&#34;</span>,
        <span style=color:#f92672>&#34;iot_slave&#34;</span>: <span style=color:#66d9ef>true</span> 
      },
      { 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://nginx:80&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;nginx-mservice-cluster1&#34;</span>, 
        <span style=color:#f92672>&#34;iot_slave&#34;</span>: <span style=color:#66d9ef>true</span> 
      },
    ] 
}
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ socketxp --config config.json
</code></pre></div><p>The above config will create a TCP listening socket at port 80 in your laptop. Make sure port 80 is free in your laptop and not used by any other application.</p><p>Next, add the follow DNS entry into your <code>/etc/hosts</code> file, so that any local DNS resolution requests to access your <code>ngnix</code> service will be routed to the SocketXP Proxy Agent listening on IP 127.0.0.1.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ echo <span style=color:#e6db74>&#34;127.0.0.1    nginx&#34;</span> | sudo tee -a /etc/hosts &gt; /dev/null
</code></pre></div><p>Now open up a browser in your laptop and point it to: http://nginx:80 or simply http://nginx. It will open up the NNGINX home page as shown below.</p><p><img src=https://dev-to-uploads.s3.amazonaws.com/i/naop7dmmxxkordq6uqdh.png alt="socketxp microservice remote access"></p><h2 id=share-same-set-of-microservices-between-multiple-developers>Share Same Set of Microservices Between Multiple Developers:</h2><p>SocketXP Microservice Remote Access solution allows multiple developers to share same set of microservices running in a development server or K8s cluster. You can create a many-to-one channel for each microservice that needs to be accessed remotely.</p><p>In SocketXP parlance, the SocketXP service proxy agent running as a standalone deployment along side a microservice (that needs to be accessed remotely) in a K8s cluster is called the master.  And the SocketXP service proxy agent running in the developer&rsquo;s laptop is called the slave.  Many slave instances of SocketXP proxy agent could run simultaneously on different developer&rsquo;s laptop and connect using a secure channel to the master instance of SocketXP proxy agent.</p><p>For the example usecase discussed in this document, each developer would run a SocketXP proxy agent on their laptop with the following config.json file to connect to the Postgresql DB and Nginx microservice running in your remote server/cluster. This communication channel goes via the single instance of the SocketXP proxy agent running in your remote server or cluster.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#960050;background-color:#1e0010>cat</span> <span style=color:#960050;background-color:#1e0010>config.json</span>
{
    <span style=color:#f92672>&#34;authtoken&#34;</span>: <span style=color:#e6db74>&#34;&lt;your-auth-token-goes-here&gt;&#34;</span>
    <span style=color:#e6db74>&#34;tunnel_enabled&#34;</span>: <span style=color:#66d9ef>true</span>, 
    <span style=color:#f92672>&#34;tunnels&#34;</span> : [
      { 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://postgres:5432&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;postgres-mservice-cluster1&#34;</span>,
        <span style=color:#f92672>&#34;iot_slave&#34;</span>: <span style=color:#66d9ef>true</span> 
      },
      { 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://nginx:80&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;nginx-mservice-cluster1&#34;</span>, 
        <span style=color:#f92672>&#34;iot_slave&#34;</span>: <span style=color:#66d9ef>true</span> 
      },
    ] 
}
</code></pre></div><p>Basically a many-to-one secure communication channel is created to aid multiple developers share the same set of microservices running in a remote server or cluster.</p><h2 id=kubernetes-microservice-remote-access>Kubernetes Microservice Remote Access:</h2><p>So far, in our dicussion we have run the SocketXP proxy agent as a Docker container or as a binary natively. We could potentially deploy SocketXP proxy agent as a Kubernetes Deployment to remote access microservices running in a K8s cluster.</p><p>To remotely access a microservice running in a Kubernetes(K8s) cluster or a minikube cluster, you need to run the SocketXP proxy agent as a Standalone Deployment in the cluster.</p><p>Instructions to run SocketXP proxy agent Docker container as a standalone deployment in a Kubernetes cluster can be found in this documentation page:</p><p><a href=https://www.socketxp.com/docs/guide/kubernetes-cluster-remote-access.html#standalone-container>https://www.socketxp.com/docs/guide/kubernetes-cluster-remote-access.html#standalone-container</a></p><p>The only difference is that you need to use the following <code>config.json</code> file(same as the one used earlier above):</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#960050;background-color:#1e0010>$</span> <span style=color:#960050;background-color:#1e0010>cat</span> <span style=color:#960050;background-color:#1e0010>config.json</span>
{
    <span style=color:#f92672>&#34;authtoken&#34;</span>: <span style=color:#e6db74>&#34;&lt;your-auth-token-goes-here&gt;&#34;</span>
    <span style=color:#e6db74>&#34;tunnel_enabled&#34;</span>: <span style=color:#66d9ef>true</span>, 
    <span style=color:#f92672>&#34;tunnels&#34;</span> : [
      { 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://postgres:5432&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;postgres-mservice-cluster1&#34;</span>, 
      },
      { 
        <span style=color:#f92672>&#34;destination&#34;</span>: <span style=color:#e6db74>&#34;tcp://nginx:80&#34;</span>, 
        <span style=color:#f92672>&#34;iot_device_id&#34;</span>: <span style=color:#e6db74>&#34;nginx-mservice-cluster1&#34;</span>, 
      },
    ] 
}
</code></pre></div><p>The above config.json file assumes that your Postgresql DB and Nginx microservices are accessible within the cluster using the DNS names <code>postgres</code> and <code>nginx</code>.</p><p>::: warning Need Support?
We are looking for early users to evaluate our SocketXP Microservice Remote Access Solution. Please write to us at: <a href=support@socketxp.com>support@socketxp.com</a> if you have any questions or need any support.
:::</p></article><section class=post-nav><ul><li><a href=http://www.ethernetresearch.com/geekzone/kubernetes-pod-remote-ssh-access/><i class="fa fa-chevron-circle-left"></i>Kubernetes Pod Remote SSH Access</a></li><li><a href=http://www.ethernetresearch.com/geekzone/kubernetes-dashboard-remote-access/>Kubernetes Dashboard Remote Access <i class="fa fa-chevron-circle-right"></i></a></li></ul></section></main><footer><h6>Copyright © 2021 - Ethernet Research | All Rights Reserved.</h6></footer></div><script src=http://www.ethernetresearch.com/js/scripts.js></script></body></html>